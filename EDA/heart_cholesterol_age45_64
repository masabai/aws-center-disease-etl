WITH high_cholestol_age AS(
SELECT LOCATIONABBR, STRATIFICATION1,
       ROUND(AVG(DATAVALUE),1) AS avg_val,
       MIN(DATAVALUE) AS min_val,
       MAX(DATAVALUE) AS max_val
FROM CHRONIC 
WHERE TOPIC ='Cardiovascular Disease'
  AND LOCATIONABBR NOT IN ('PR', 'GU', 'VI', 'AS', 'MP')
  AND DATAVALUE IS NOT NULL
  --AND DATASOURCE = 'BRFSS'
  AND QUESTION = 'High cholesterol among adults who have been screened'
  AND STRATIFICATION1 IN ('Age 45-64') --, 'Asian, non-Hispanic', 'Female')
GROUP BY LOCATIONABBR, STRATIFICATION1
)

SELECT * --AVG(avg_val), MIN(min_val), MAX(max_val)
FROM  high_cholestol_age 
WHERE min_val < 39--< 33 (2), < 35 (6) < 39 (25)
ORDER BY min_val


